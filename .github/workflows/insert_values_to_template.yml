on:
  workflow_dispatch:
    inputs:
      project_prefix_variable:
        description: 'Variable name to point to your project path'
        default: 'MY_PROTEIN_PREFIX'
        required: true
      project_name:
        description: 'System name'
        required: true

jobs:
  insert-values:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Insert values
        run: |
          grep -rl 'TEMPLATE_PROJECT_PREFIX' * | xargs sed -i 's!TEMPLATE_PROJECT_PREFIX!${{ github.event.inputs.project_prefix }}!g'
          grep -rl 'TEMPLATE_SYSTEM_NAME' * | xargs sed -i -e 's!TEMPLATE_SYSTEM_NAME!${{ github.event.inputs.system_name }}!g'
          rm .github/workflows/insert_values_to_template.yml
      - name: Commit
        run: |
          git remote set-url origin https://github-actions:${GITHUB_TOKEN}@github.com/${GITHUB_REPOSITORY}
          git config --local user.name "${GITHUB_ACTOR}"
          git config --global user.email "${GITHUB_ACTOR}@users.noreply.github.com"
          git add .
          git commit -m "Fill values in template"
          git push origin main